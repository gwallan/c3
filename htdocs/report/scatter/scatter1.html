<html>
  <head>
    <link rel="stylesheet" type="text/css" href="../../css/c3.css">
    <style>
      .c3-grid line{
        stroke: #F44336;
      }
      .c3-xgrids .c3-xgrid:first-child{
        opacity: 1!important;
      }
    </style>
  </head>
  <body>
    <div id="chart"></div>

    <script src="../../js/system.js"></script>
    <script>
      System.defaultJSExtensions = true;
      // set our baseURL reference path
      System.config({
        baseURL: '../../../src/',
        meta: {
            'c3.js': {
            format: 'cjs'
            }
        },
        map: {
            "underscore": "../../../node_modules/underscore/underscore.js",
            "pathseg": "../../../node_modules/pathseg/pathseg.js",
            "d3": "../../../node_modules/d3/d3.js"
        }
    });
      System.import('component/c3-combin.js').then(function(c3){
        function Point(ele) {
          var pos = ele.getAttribute("transform").replace("translate(", "").replace(")", "").split(",");

          return {
            "X": pos[0],
            "Y": pos[1]
          };
        }
        function getDistance( point1, point2 )
        {
          var xs = 0;
          var ys = 0;

          xs = point2.X - point1.X;
          xs = xs * xs;

          ys = point2.Y - point1.Y;
          ys = ys * ys;

          return Math.sqrt( xs + ys );
        }

        var data = {
          "xs":{
            "魅蓝Marketing平台":"魅蓝Marketing平台_x",
            // "魅蓝品牌管理部":"魅蓝品牌管理部_x",
            // "魅蓝事业部":"魅蓝事业部_x",
            // "支持分析平台":"支持分析平台_x"
          },
          "columns":[
            ["魅蓝Marketing平台",2],
            ["魅蓝Marketing平台_x",390],
            ["魅蓝Marketing平台_r",6055.555],
            // ["魅蓝品牌管理部",0],
            // ["魅蓝品牌管理部_x",154],
            // ["魅蓝品牌管理部_r",6055.555],
            // ["魅蓝事业部",0],
            // ["魅蓝事业部_x",155],
            // ["魅蓝事业部_r",6055.555],
            // ["支持分析平台",11.11],
            // ["支持分析平台_x",344],
            // ["支持分析平台_r",6055.555]
          ],
          "type":"scatter"
        };

        c3.generate({
          transition: { enabled: false, duration: 1500 },
          color: {
            pattern: [
              "#7167EA",
              "#23A2F5",
              "#EE3758",
              "#FDBA50",
              "#80CB54",
              "#1F97A6",
              "#B364D8",
              "#FF7CDC",
              "#FDDD00",
              "#56D9F3",
              "#EC6901",
              "#47885E",
              "#275FDF",
              "#88A8BD"
            ]
          },
          bindto: "#chart",
          data: {
            xs: {
              市场营销部: "市场营销部_x",
              商业智能部: "商业智能部_x",
              网络开发部: "网络开发部_x",
              设计部: "设计部_x",
              销售事业一部: "销售事业一部_x"
            },
            columns: [
              [
                "市场营销部",
                0.64,
                0.74,
                0.14,
                0.04,
                0.78,
                0.38,
                0.55,
                0.72,
                0.02,
                0.15,
                0.47,
                0.57,
                0.21,
                0.06,
                0.38,
                0.96,
                0.73,
                0.96,
                0.45,
                0.61,
                0.87,
                0.13,
                0.82,
                0.41,
                0.71,
                0.48,
                0.75,
                0.23,
                0.08,
                0.92,
                1,
                0.59,
                0.56,
                0.32,
                0.04,
                0.74,
                0.62,
                0.35,
                0.44,
                0.51,
                0.58,
                0.63,
                0.29,
                0.16,
                0.38,
                0.52,
                0.8,
                0.72,
                0.94,
                0.04,
                1,
                2.22,
                3934.88
              ],
              [
                "市场营销部_x",
                0,
                14,
                37,
                38,
                44,
                44,
                44,
                46,
                46,
                49,
                51,
                56,
                56,
                56,
                60,
                63,
                63,
                65,
                77,
                81,
                86,
                87,
                98,
                98,
                102,
                114,
                115,
                115,
                119,
                119,
                119,
                119,
                122,
                122,
                127,
                127,
                127,
                130,
                141,
                142,
                164,
                176,
                198,
                217,
                220,
                276,
                301,
                303,
                324,
                407,
                529,
                532,
                557
              ],
              [
                "市场营销部_r",
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                3934.88
              ],
              ["商业智能部", 12.35, 12, 0.1, 0.01, 2, 0, 0, 421.63, 0],
              ["商业智能部_x", 529, 529, 529, 535, 535, 540, 540, 540, 541],
              [
                "商业智能部_r",
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44,
                1967.44
              ],
              ["网络开发部", 1.11, 0.01, 0.01, 123.31, 0, 0.02],
              ["网络开发部_x", 535, 536, 536, 536, 536, 539],
              ["网络开发部_r", 1967.44, 1967.44, 1967.44, 1967.44, 1967.44, 1967.44],
              ["设计部", 2.34],
              ["设计部_x", 540],
              ["设计部_r", 1967.44],
              ["销售事业一部", 1.21],
              ["销售事业一部_x", 541],
              ["销售事业一部_r", 1967.44]
            ],
            type: "scatter"
          },
          padding: { right: 40, top: 30, left: 100, bottom: 20 },
          axis: {
            x: {
              // min: 0,
              padding: { right: 0 },
              tick: {
                mark: true,
                count: 8,
                "format": function(v){
                  if (!v) return 0  // 0时返回0
                  if (parseInt(v) == v) return v  // 整形时,返回原值
                  if (parseFloat(v) == v) return parseFloat(v).toFixed(2)  // 数字时,取2位小数
                  return v;  // 非数字时,返回原值
                }
              }
            },
            y: { show: true, min: 0, max: 3935, tick: { count: 5 } }
          },
          grid: { x: { show: true, type: "tick" }, y: { show: true } },
          legend: { shape: "circle", position: "bottom" },
          scatter: {
            symbol: { min: 5, max: 15 }
          },
          tooltip: { show: false }
        }, function(){
          this.parser
            .y([
              "市场营销部",
              "商业智能部",
              "网络开发部",
              "设计部",
              "销售事业一部"
            ])
            .other({
              "市场营销部_x": "市场营销部",
              "商业智能部_x": "商业智能部",
              "网络开发部_x": "网络开发部",
              "设计部_x": "设计部",
              "销售事业一部_x": "销售事业一部"
            })
        });
        return;

        var chart = c3.generate({
          transition: {
            enabled: false,
            duration: 1500
          },
          data: {
            ...data,
            // xs: {
            //   "setosa_y": 'setosa_x',
            //   "versicolor_y": 'versicolor_x',
            //   "virginica_y": 'virginica_x'
            // },
            // columns: [
            //   ["setosa_x", 3, 1, 3],
            //   ["setosa_y", 10, 5, 5],
            //   ["setosa", 1, 4, 8],
            //   ["versicolor_x", 4, 4, 5],
            //   ["versicolor_y", 3, 3, 3],
            //   ["versicolor", 2.4, 1.8, 2.5],
            //   ["virginica_x", 3.3, 2.7, 3.0, 2.9, 3.0],
            //   ["virginica_y", 3, 3, 3, 2, 2],
            //   ["virginica", 2.5, 1.9, 2.1, 1.8, 6.2],
            // ],
            type : 'scatter',
            onmouseover: function(d, ele){
              var point = Point(ele);
              var circles = this.query(".c3-circle").filter(function(d){
                var _point = Point(this);
                var dist = getDistance(point, _point);

                return dist < +ele.getAttribute("r") + +this.getAttribute("r");
              });

              console.log(circles.data());
            }
          },
          padding: {
            left: 20,
            right: 20,
            top: 10
          },
          axis: {
            x: {
              // min: 0,
              max: 500,
              // label: '日期',
              // "type":"category",
              padding: {
                right: 0
              },
              tick: {
                mark: true,
                count: 10,
                padding: 15,
                fit: false,
                // values: ["12-05","12-06","12-07"],
                "format": function(v){
                  console.log(v)
                  if (!v) return 0  // 0时返回0
                  if (parseInt(v) == v) return v  // 整形时,返回原值
                  if (parseFloat(v) == v) return parseFloat(v).toFixed(2)  // 数字时,取2位小数
                  return v;  // 非数字时,返回原值
                }
              }
            },
            y: {
              show: false,
              min: 0,
              label: 'Petal.Width',
              tick: {
                "format": function(v){
                  if (!v) return 0  // 0时返回0
                  if (parseInt(v) == v) return v  // 整形时,返回原值
                  if (parseFloat(v) == v) return parseFloat(v).toFixed(2)  // 数字时,取2位小数
                  return v;  // 非数字时,返回原值
                }
              },
            }
          },
          grid: {
            x: {
              show: true,
              type: 'tick'
            },
            y: {
              show: true
            }
          },
          legend: {
            "shape":"square",
            "position": "inset",
            "inset": {
              "step": 1,
              "anchor": "top-right"
            }
          },
          scatter: {
            symbol: {
              min: 5,
              max: 15
            }
          }
        }, function(){
          this.parser
            .y([
              "魅蓝Marketing平台",
              // "支持分析平台",
              // "魅蓝品牌管理部",
              // "魅蓝事业部"
            ])
            .other({
              "魅蓝Marketing平台_x": "魅蓝Marketing平台",
              // "支持分析平台_x": "支持分析平台",
              // "魅蓝品牌管理部_x": "魅蓝品牌管理部",
              // "魅蓝事业部_x": "魅蓝事业部"
            })
        });
      });
    </script>
  </body>
</html>
